run_name: "fno_temporal_split"  # Train on first n snapshots, predict rest

paths:
  output_base: "/work/10407/anthony50102/vista/"
  
  data_dir: "/work/10407/anthony50102/vista/"
  
  # Single trajectory for temporal split mode
  training_files: 
    - "test_nu5e-9.h5"

  # test_files not used in temporal_split mode (we use later part of training file)
  test_files: []

physics:
  dt: 0.025
  n_fields: 2
  n_x: 512
  n_y: 512

# Training mode configuration
training_mode: "temporal_split"
train_start: 8000      # Train from snapshot 8000
train_end: 16000       # Train to snapshot 16000  
test_start: 16000      # Test from snapshot 16000
test_end: 20000  
  #train_start: 8100      # Train from snapshot 8000
  #train_end: 8200       # Train to snapshot 16000  
  #test_start: 8300      # Test from snapshot 16000
  #test_end: 8400

# FNO model configuration
model:
  n_modes: [64, 64]     # Fourier modes in each dimension
  in_channels: 2        # density + potential
  out_channels: 2       # predict next density + potential
  hidden_channels: 128  # Width of the network
  n_layers: 4           # Number of Fourier layers

# Training configuration
training:
  batch_size: 16        # Pairs per mini-batch
  n_epochs: 100         # Number of training epochs
  learning_rate: 1.0e-3
  weight_decay: 1.0e-4
  grad_clip: 1.0        # Gradient clipping norm
  noise_std: 0.01       # Input noise for rollout robustness (step 2)
  gradient_checkpointing: true  # Save memory during rollout training
  
  # Learning rate scheduler
  scheduler:
    type: "cosine"      # "cosine", "step", or "none"
    warmup_epochs: 5
  
  # Checkpointing
  save_every: 20        # Save checkpoint every N epochs
  eval_every: 10        # Evaluate on test set every N epochs

# Step 2: Curriculum for autoregressive rollout training
# Format: [rollout_length, teacher_forcing_ratio, n_epochs]
# Teacher forcing: high early (training wheels) â†’ low late (self-correct)
curriculum:
  - [5,  0.8, 20]   # Stage 1: Short rollouts, 80% teacher forcing
  - [10, 0.6, 20]   # Stage 2: Medium rollouts, 60% teacher forcing
  - [20, 0.4, 20]   # Stage 3: Longer rollouts, 40% teacher forcing
  - [40, 0.2, 20]   # Stage 4: Long rollouts, 20% teacher forcing
  - [80, 0.0, 30]   # Stage 5: Full autoregressive (no teacher forcing)

# Logging
log_level: "INFO"
